# æ°”ä½“å…‰è°±åˆ†æç³»ç»Ÿ - åŸºäºåæœ€å°äºŒä¹˜æ³•çš„ä¸‰æ°”ä½“æµ“åº¦é¢„æµ‹

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäº**åæœ€å°äºŒä¹˜æ³•ï¼ˆPLSï¼‰å›å½’**çš„æ°”ä½“å…‰è°±åˆ†æå·¥å…·ï¼Œä¸“é—¨ç”¨äºé¢„æµ‹**NOã€NO2ã€SO2**ä¸‰ç§æ°”ä½“çš„æµ“åº¦ã€‚ç³»ç»ŸåŒ…å«ä¸¤ä¸ªè®­ç»ƒå¥½çš„æ¨¡å‹ï¼šEnhancedæ¨¡å‹ï¼ˆåŸºäºå¢å¼ºæ•°æ®é›†ï¼‰å’ŒStandardæ¨¡å‹ï¼ˆåŸºäºHITRANæ ‡å‡†æ•°æ®åº“ï¼‰ã€‚

### ğŸ¯ ä¸»è¦åŠŸèƒ½
- **å…‰è°±æ•°æ®é¢„å¤„ç†**ï¼šè‡ªåŠ¨æ’å€¼ã€æ ‡å‡†åŒ–ã€å™ªå£°å¤„ç†
- **å¤šæ¨¡å‹é¢„æµ‹**ï¼šEnhanced + Standard åŒæ¨¡å‹é¢„æµ‹
- **æ™ºèƒ½æ•°æ®åˆ†å‰²**ï¼šé¿å…æ•°æ®æ³„éœ²çš„è®­ç»ƒç­–ç•¥
- **ç»¼åˆç»“æœè¾“å‡º**ï¼šæä¾›å¤šç§æ ¼å¼çš„é¢„æµ‹ç»“æœ

---

## ğŸ—‚ï¸ æ–‡ä»¶ç»“æ„è¯¦è§£

### ğŸ“ æ ¸å¿ƒè®­ç»ƒæ–‡ä»¶
```
gas_three/
â”œâ”€â”€ 01_preprocess.pyï¼ˆä¸‰æ°”ä½“ç‰ˆï¼‰.py     # HITRANæ•°æ®é¢„å¤„ç†å’Œæ’å€¼
â”œâ”€â”€ 02_generate_mixture.pyï¼ˆä¸‰æ°”ä½“ç‰ˆï¼‰.py # å•ä¸€æ··åˆæ ·æœ¬ç”Ÿæˆ
â”œâ”€â”€ 03_generate_dataset.pyï¼ˆä¸‰æ°”ä½“ç‰ˆï¼‰.py # å¢å¼ºè®­ç»ƒæ•°æ®é›†ç”Ÿæˆ
â”œâ”€â”€ 04a_pls_model_default.pyï¼ˆä¸‰æ°”ä½“ç‰ˆï¼‰.py # é»˜è®¤PLSæ¨¡å‹è®­ç»ƒ
â”œâ”€â”€ 04b_pls_model_custom.pyï¼ˆä¸‰æ°”ä½“ç‰ˆï¼‰.py  # è‡ªé€‚åº”PLSæ¨¡å‹è®­ç»ƒ
â””â”€â”€ build_standard_model.py            # æ ‡å‡†æ¨¡å‹æ„å»ºå™¨
```

### ğŸ¤– æ¨¡å‹æ–‡ä»¶
```
data/models/
â”œâ”€â”€ enhanced_pls_model.pkl              # Enhanced PLSæ¨¡å‹
â”œâ”€â”€ scaler_X.pkl                        # Enhancedæ¨¡å‹Xæ ‡å‡†åŒ–å™¨
â”œâ”€â”€ scaler_Y.pkl                        # Enhancedæ¨¡å‹Yæ ‡å‡†åŒ–å™¨
â””â”€â”€ standard/
    â”œâ”€â”€ standard_pls_model.pkl          # Standard PLSæ¨¡å‹
    â”œâ”€â”€ standard_scaler_X.pkl           # Standardæ¨¡å‹Xæ ‡å‡†åŒ–å™¨
    â””â”€â”€ standard_scaler_Y.pkl           # Standardæ¨¡å‹Yæ ‡å‡†åŒ–å™¨
```

### ğŸ”§ å®ç”¨å·¥å…·
```
gas_three/
â”œâ”€â”€ how_to_detect.py                    # å¿«é€Ÿæ£€æµ‹å·¥å…·ï¼ˆæ¨èï¼‰
â”œâ”€â”€ detect_spectrum.py                  # å®Œæ•´æ£€æµ‹è„šæœ¬
â”œâ”€â”€ predict_with_standard.py            # Standardæ¨¡å‹é¢„æµ‹
â”œâ”€â”€ predict_real.py                     # Enhancedæ¨¡å‹é¢„æµ‹
â”œâ”€â”€ how_to_use.py                       # ç³»ç»Ÿä½¿ç”¨æŒ‡å—
â”œâ”€â”€ check_status.py                     # ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
â”œâ”€â”€ demo.py                             # æ¼”ç¤ºè„šæœ¬
â””â”€â”€ standard_model_summary.py           # æ¨¡å‹æ€»ç»“
```

### ğŸ“Š æ•°æ®ç®¡ç†
```
data/
â”œâ”€â”€ processed/                          # é¢„å¤„ç†æ•°æ®
â”‚   â”œâ”€â”€ interpolated_spectra.csv        # Enhancedæ¨¡å‹å‚è€ƒå…‰è°±
â”‚   â”œâ”€â”€ standard_interpolated_spectra.csv # Standardæ¨¡å‹å‚è€ƒå…‰è°±
â”‚   â”œâ”€â”€ X_dataset.csv                   # è®­ç»ƒç‰¹å¾æ•°æ®
â”‚   â”œâ”€â”€ Y_labels.csv                    # è®­ç»ƒæ ‡ç­¾æ•°æ®
â”‚   â”œâ”€â”€ X_train.csv, X_val.csv, X_test.csv # æ•°æ®åˆ†å‰²ç»“æœ
â”‚   â””â”€â”€ generation_params.json          # æ•°æ®ç”Ÿæˆå‚æ•°
â”œâ”€â”€ raw/                                # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ X_real.csv                      # å¾…é¢„æµ‹å…‰è°±æ•°æ®
â”‚   â””â”€â”€ Y_real.csv                      # çœŸå®æµ“åº¦ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ results/                            # é¢„æµ‹ç»“æœ
â”‚   â”œâ”€â”€ detection/                      # æ£€æµ‹ç»“æœ
â”‚   â””â”€â”€ standard/                       # Standardæ¨¡å‹ç»“æœ
â””â”€â”€ figures/                            # å¯è§†åŒ–å›¾è¡¨
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
```bash
python check_status.py
```
**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ENHANCED GAS SPECTROSCOPY SYSTEM STATUS
============================================================
1. CORE FILES STATUS:
   Base spectra: âœ“
   Enhanced dataset: âœ“
   Training data: âœ“
   Enhanced model: âœ“
   Data scalers: âœ“

5. SYSTEM STATUS:
   Status: READY
```

### 2ï¸âƒ£ æœ€ç®€å•çš„æ£€æµ‹æ–¹æ³•ï¼ˆæ¨èï¼‰
```bash
python how_to_detect.py your_spectrum.csv
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
QUICK SPECTRUM DETECTION
========================================
File: your_spectrum.csv
Loaded: 3104 data points

DETECTION RESULTS:
------------------------------
Standard Model:
  NO: 0.274 (27.4%)
  NO2: 0.301 (30.1%)
  SO2: 0.426 (42.6%)

Enhanced Model:
  NO: 0.667 (66.7%)
  NO2: 0.333 (33.3%)
  SO2: 0.000 (0.0%)

Consensus (Average):
  NO: 0.470 (47.0%)
  NO2: 0.317 (31.7%)
  SO2: 0.213 (21.3%)
```

---

## ğŸ“ è¯¦ç»†ä½¿ç”¨æµç¨‹

### ğŸ”§ æ–¹æ³•ä¸€ï¼šå‘½ä»¤è¡Œå¿«é€Ÿæ£€æµ‹
```bash
# æ£€æµ‹å•ä¸ªæ–‡ä»¶
python how_to_detect.py /path/to/your/spectrum.csv

# ä½¿ç”¨å®Œæ•´æ£€æµ‹åŠŸèƒ½
python detect_spectrum.py /path/to/your/spectrum.csv

# ä»…ä½¿ç”¨Standardæ¨¡å‹
python predict_with_standard.py /path/to/your/spectrum.csv
```

### ğŸ’» æ–¹æ³•äºŒï¼šPythonä»£ç é›†æˆ
```python
from how_to_detect import quick_detect

# å¿«é€Ÿæ£€æµ‹
result = quick_detect('your_spectrum.csv')

# ç»“æœæ ¼å¼
# result = {
#     'Standard': [NO_conc, NO2_conc, SO2_conc],
#     'Enhanced': [NO_conc, NO2_conc, SO2_conc]
# }
```

### ğŸ—‚ï¸ æ–¹æ³•ä¸‰ï¼šæ ‡å‡†æ•°æ®è·¯å¾„
1. å°†å…‰è°±æ•°æ®ä¿å­˜ä¸ºï¼š`data/raw/X_real.csv`
2. è¿è¡Œï¼š`python predict_real.py`

---

## ğŸ“Š æ•°æ®æ ¼å¼è¦æ±‚

### è¾“å…¥æ•°æ®æ ¼å¼
```csv
wavenumber,intensity
587.0,9.643139671328989e-26
588.0,8.733509209604609e-23
589.0,2.2142589032825055e-22
...
```

**è¦æ±‚**ï¼š
- **æ–‡ä»¶æ ¼å¼**ï¼šCSV
- **åˆ—1**ï¼šwavenumberï¼ˆæ³¢æ•°ï¼Œcmâ»Â¹ï¼‰æˆ– frequency
- **åˆ—2**ï¼šintensityï¼ˆå¼ºåº¦ï¼‰æˆ– absorbance
- **æ•°æ®èŒƒå›´**ï¼šå»ºè®®è¦†ç›– 586.7-3690.6 cmâ»Â¹
- **æ•°æ®ç‚¹æ•°**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨æ’å€¼åˆ°3104ä¸ªæ ‡å‡†æ³¢æ•°ç‚¹

### è¾“å‡ºç»“æœæ ¼å¼
```csv
Model,NO_concentration,NO_percentage,NO2_concentration,NO2_percentage,SO2_concentration,SO2_percentage
standard,0.2736,27.4,0.3006,30.1,0.4258,42.6
enhanced,0.6669,66.7,0.3331,33.3,0.0,0.0
CONSENSUS,0.4702,47.0,0.3169,31.7,0.2129,21.3
```

---

## ğŸ§  æ¨¡å‹æŠ€æœ¯è¯¦è§£

### ğŸ”¬ ç®—æ³•åŸç†
- **ç®—æ³•**ï¼šåæœ€å°äºŒä¹˜æ³•ï¼ˆPLSï¼‰å›å½’
- **å®ç°**ï¼š`sklearn.cross_decomposition.PLSRegression`
- **åŸç†**ï¼šå°†é«˜ç»´å…‰è°±æ•°æ®é™ç»´åˆ°ä½ç»´ä¸»æˆåˆ†ç©ºé—´ï¼ŒåŒæ—¶è€ƒè™‘è¾“å…¥å’Œè¾“å‡ºçš„åæ–¹å·®å…³ç³»

### ğŸ“ˆ æ¨¡å‹å‚æ•°

| å‚æ•° | Enhancedæ¨¡å‹ | Standardæ¨¡å‹ |
|------|-------------|-------------|
| **ä¸»æˆåˆ†æ•°** | 10 | 10 |
| **è¾“å…¥ç‰¹å¾** | 3,104 | 3,104 |
| **è¾“å‡ºç›®æ ‡** | 3ï¼ˆNO, NO2, SO2ï¼‰ | 3ï¼ˆNO, NO2, SO2ï¼‰ |
| **è®­ç»ƒæ ·æœ¬** | 10,545 | 3,690 |
| **å”¯ä¸€ç»„åˆ** | 703 | 369 |
| **Test RÂ²** | 0.86160 | 0.99122 |
| **Test RMSE** | 0.06311 | 0.01686 |

### ğŸ¯ ä¸¤ä¸ªæ¨¡å‹çš„åŒºåˆ«

**Enhancedæ¨¡å‹**ï¼š
- åŸºäºå¢å¼ºæ•°æ®é›†è®­ç»ƒ
- åŒ…å«å¤æ‚å™ªå£°æ¨¡å‹å’Œéçº¿æ€§æ•ˆåº”
- æ›´çœŸå®çš„æ€§èƒ½è¡¨ç°
- é€‚åˆä¸€èˆ¬å…‰è°±æ•°æ®

**Standardæ¨¡å‹**ï¼š
- åŸºäºHITRANæ ‡å‡†æ•°æ®åº“
- ä¸“é—¨é’ˆå¯¹æ ‡å‡†æ°”ä½“ä¼˜åŒ–
- æ›´é«˜çš„é¢„æµ‹ç²¾åº¦
- é€‚åˆæ ‡å‡†æ°”ä½“å…‰è°±

---

## ğŸ”„ ç³»ç»Ÿé‡å»ºæµç¨‹

### é‡æ–°ç”ŸæˆEnhancedæ¨¡å‹
```bash
# å®Œæ•´æµæ°´çº¿é‡å»º
python how_to_use.py --retrain

# åˆ†æ­¥éª¤é‡å»º
python "03_generate_dataset.pyï¼ˆä¸‰æ°”ä½“ç‰ˆï¼‰.py"  # ç”Ÿæˆæ•°æ®
python data_splitter.py                        # æ•°æ®åˆ†å‰²
python enhanced_model_trainer.py               # è®­ç»ƒæ¨¡å‹
```

### é‡æ–°ç”ŸæˆStandardæ¨¡å‹
```bash
# ä¸€é”®é‡å»ºStandardæ¨¡å‹
python build_standard_model.py

# æˆ–ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬ï¼ˆå·²å†…ç½®ï¼‰
```

---

## ğŸ“‹ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

**1. æ¨¡å‹æ–‡ä»¶æœªæ‰¾åˆ°**
```bash
# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
python check_status.py

# é‡æ–°æ„å»ºæ¨¡å‹
python how_to_use.py  # Enhancedæ¨¡å‹
python build_standard_model.py  # Standardæ¨¡å‹
```

**2. ç‰¹å¾ç»´åº¦ä¸åŒ¹é…**
- ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒæ•´ç‰¹å¾ç»´åº¦
- å¦‚æœæ•°æ®ç‚¹è¿‡å°‘ï¼Œä¼šè‡ªåŠ¨å¡«å……é›¶å€¼
- å¦‚æœæ•°æ®ç‚¹è¿‡å¤šï¼Œä¼šæˆªå–å‰3104ä¸ªç‚¹

**3. æ•°æ®æ ¼å¼é”™è¯¯**
```python
# æ£€æŸ¥æ•°æ®æ ¼å¼
import pandas as pd
df = pd.read_csv('your_file.csv')
print(df.head())
print(df.columns)
```

**4. é¢„æµ‹ç»“æœå¼‚å¸¸**
- æ£€æŸ¥è¾“å…¥å…‰è°±çš„æ³¢æ•°èŒƒå›´æ˜¯å¦åˆç†
- ç¡®è®¤å¼ºåº¦æ•°å€¼åœ¨åˆç†èŒƒå›´å†…
- æ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœ

---

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰æ•°æ®ç”Ÿæˆå‚æ•°
ç¼–è¾‘ `03_generate_dataset.pyï¼ˆä¸‰æ°”ä½“ç‰ˆï¼‰.py`ï¼š
```python
# å™ªå£°æ°´å¹³è°ƒæ•´
base_noise_level = 0.08        # åŸºç¡€å™ªå£°ï¼ˆé»˜è®¤8%ï¼‰
spectral_noise_level = 0.05    # å…‰è°±å™ªå£°ï¼ˆé»˜è®¤5%ï¼‰
nonlinear_strength = 0.15      # éçº¿æ€§å¼ºåº¦ï¼ˆé»˜è®¤15%ï¼‰

# æµ“åº¦èŒƒå›´è°ƒæ•´
no_ratios = np.arange(0.05, 0.65, 0.02)   # NOæµ“åº¦èŒƒå›´
no2_ratios = np.arange(0.05, 0.65, 0.02)  # NO2æµ“åº¦èŒƒå›´
```

### è‡ªå®šä¹‰æ¨¡å‹å‚æ•°
ç¼–è¾‘è®­ç»ƒè„šæœ¬ä¸­çš„PLSå‚æ•°ï¼š
```python
# ä¿®æ”¹ä¸»æˆåˆ†æ•°
model = PLSRegression(n_components=10)  # å¯è°ƒæ•´ä¸º5-20

# ä¿®æ”¹äº¤å‰éªŒè¯å‚æ•°
kfold = KFold(n_splits=5, shuffle=True, random_state=42)
```

---

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•

### Enhancedæ¨¡å‹æ€§èƒ½
- **è®­ç»ƒé›† RÂ²**ï¼š0.91134
- **æµ‹è¯•é›† RÂ²**ï¼š0.86160
- **æµ‹è¯•é›† RMSE**ï¼š0.06311
- **æ³›åŒ–è¯¯å·®**ï¼š0.01415ï¼ˆåˆç†èŒƒå›´ï¼‰

### Standardæ¨¡å‹æ€§èƒ½
- **è®­ç»ƒé›† RÂ²**ï¼šâ‰ˆ0.99
- **æµ‹è¯•é›† RÂ²**ï¼š0.99122
- **æµ‹è¯•é›† RMSE**ï¼š0.01686
- **è®­ç»ƒæ ·æœ¬**ï¼š3,690ä¸ª

### å•æ°”ä½“æ€§èƒ½ï¼ˆEnhancedæ¨¡å‹ï¼‰
- **NO**ï¼šRÂ² = 0.87017, RMSE = 0.05633
- **NO2**ï¼šRÂ² = 0.84804, RMSE = 0.06008
- **SO2**ï¼šRÂ² = 0.86658, RMSE = 0.07189

---

## ğŸ” ç³»ç»Ÿç‰¹è‰²

### âœ… è§£å†³çš„å…³é”®é—®é¢˜
1. **æ•°æ®æ³„éœ²**ï¼šè®­ç»ƒæµ‹è¯•é›†æµ“åº¦ç»„åˆé›¶é‡å 
2. **è¿‡æ‹Ÿåˆ**ï¼šä»ä¸ç°å®çš„RÂ²â‰ˆ1.0é™è‡³åˆç†çš„RÂ²â‰ˆ0.86
3. **æ•°æ®å¤æ‚æ€§**ï¼šå¤šå±‚æ¬¡å™ªå£°æ¨¡å‹æ¨¡æ‹ŸçœŸå®æ¡ä»¶
4. **æ¨¡å‹é²æ£’æ€§**ï¼šä¸¥æ ¼çš„äº¤å‰éªŒè¯å’Œæ•°æ®åˆ†å‰²

### ğŸ¯ æŠ€æœ¯äº®ç‚¹
1. **æ™ºèƒ½æ•°æ®åˆ†å‰²**ï¼šåŸºäºæµ“åº¦ç»„åˆçš„åˆ†ç»„åˆ†å‰²
2. **å¤šå±‚æ¬¡å™ªå£°**ï¼šé«˜æ–¯å™ªå£° + å…‰è°±ç›¸å…³å™ªå£° + ç³»ç»Ÿåå·®
3. **éçº¿æ€§æ•ˆåº”**ï¼šæ¨¡æ‹ŸçœŸå®æ°”ä½“åˆ†å­é—´ç›¸äº’ä½œç”¨
4. **åŒæ¨¡å‹èåˆ**ï¼šEnhanced + Standard æ¨¡å‹äº’è¡¥

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¦‚éœ€å¸®åŠ©
1. **ç³»ç»ŸçŠ¶æ€æ£€æŸ¥**ï¼š`python check_status.py`
2. **è¿è¡Œæ¼”ç¤ºç¨‹åº**ï¼š`python demo.py`
3. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**ï¼šæ£€æŸ¥å‘½ä»¤è¡Œè¾“å‡ºä¿¡æ¯
4. **é‡å»ºç³»ç»Ÿ**ï¼š`python how_to_use.py --retrain`

### è”ç³»ä¿¡æ¯
- **é¡¹ç›®è·¯å¾„**ï¼š`E:\generate_mixture\gas_three\`
- **æ¨¡å‹å­˜å‚¨**ï¼š`data/models/` ç›®å½•
- **ç»“æœè¾“å‡º**ï¼š`data/results/` ç›®å½•

---

## ğŸ“„ å¼•ç”¨ä¿¡æ¯

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº†æœ¬ç³»ç»Ÿï¼Œè¯·å¼•ç”¨ï¼š
- **ç®—æ³•**ï¼šPartial Least Squares (PLS) Regression
- **æ•°æ®æº**ï¼šHITRAN Database
- **å®ç°**ï¼šscikit-learn PLSRegression
- **æ¨¡å‹**ï¼šEnhanced + Standard åŒæ¨¡å‹æ¶æ„

---

*æœ€åæ›´æ–°ï¼š2025å¹´1æœˆ*